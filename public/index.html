<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F√∫tbolStore - Lo mejor en art√≠culos deportivos</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#1a1a1a',
                        'accent': '#ff6b35',
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        * {
            font-family: 'Inter', sans-serif;
        }

        .product-card:hover .product-image-main {
            opacity: 0;
        }

        .product-card:hover .product-image-hover {
            opacity: 1;
        }

        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .section-title {
            position: relative;
            display: inline-block;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 3px;
            background: #ff6b35;
        }
    </style>
</head>

<body class="bg-gray-50">

    <!-- Top Banner -->
    <div class="bg-primary text-white text-center py-2 text-sm">
        üì¶ Env√≠os gratis en compras mayores a $50 | üí≥ Acepta todos los m√©todos de pago
    </div>

    <!-- Navigation -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <h1 class="text-2xl font-bold text-primary">F√öTBOL<span class="text-accent">STORE</span></h1>
                </div>

                <!-- Menu Desktop -->
                <div class="hidden md:flex space-x-8 text-sm font-medium">
                    <a href="#" class="hover:text-accent transition">INICIO</a>
                    <a href="#" class="hover:text-accent transition">HOMBRE</a>
                    <a href="#" class="hover:text-accent transition">MUJER</a>
                    <a href="#" class="hover:text-accent transition">NI√ëOS</a>
                    <a href="#ofertas" class="text-red-500 font-bold hover:text-red-600 transition">OFERTAS</a>
                </div>

                <!-- Actions -->
                <div class="flex items-center space-x-4">
                    <!-- Auth -->
                    <div id="auth-section" class="flex items-center gap-3">
                        <a href="login.html" class="text-sm hover:text-accent transition">Iniciar Sesi√≥n</a>
                        <a href="registro.html"
                            class="bg-accent px-4 py-2 rounded text-white text-sm font-bold hover:bg-orange-600 transition">Registrarse</a>
                    </div>
                    <div id="user-section" class="hidden flex items-center gap-3">
                        <span id="user-name" class="text-sm font-medium">Usuario</span>
                        <a id="admin-link" href="admin.html"
                            class="hidden text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition">
                            Panel Admin
                        </a>
                        <button onclick="logout()"
                            class="text-xs text-red-500 hover:text-red-700 transition">Salir</button>
                    </div>

                    <!-- Cart -->
                    <button onclick="toggleCarrito()" class="relative">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z">
                            </path>
                        </svg>
                        <span id="cart-count"
                            class="absolute -top-2 -right-2 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full hidden">0</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Banner -->
    <div class="hero-gradient text-white py-20 px-4">
        <div class="container mx-auto text-center">
            <h2 class="text-5xl font-bold mb-4">Lo Mejor en Art√≠culos Deportivos</h2>
            <p class="text-xl mb-8">Encuentra los mejores productos para tu deporte favorito</p>
            <a href="#productos"
                class="bg-white text-primary px-8 py-3 rounded-full font-bold hover:bg-gray-100 transition inline-block">Ver
                Productos</a>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container mx-auto px-4 py-8">

        <!-- Cart Sidebar (Mobile/Tablet overlay) -->
        <div id="carrito-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40" onclick="toggleCarrito()">
        </div>

        <aside id="carrito-sidebar"
            class="hidden fixed right-0 top-0 h-full w-80 bg-white shadow-2xl z-50 p-6 overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold">Tu Carrito</h2>
                <button onclick="toggleCarrito()" class="text-2xl hover:text-red-500">&times;</button>
            </div>

            <div id="cart-items" class="flex flex-col gap-3 mb-6">
                <p class="text-sm text-gray-400 italic text-center">Tu carrito est√° vac√≠o</p>
            </div>

            <div class="border-t pt-4">
                <div class="flex justify-between text-lg font-bold mb-4">
                    <span>Total:</span>
                    <span>$<span id="total-price">0.00</span></span>
                </div>
                <button onclick="checkout()"
                    class="w-full bg-accent hover:bg-orange-600 text-white font-bold py-3 px-4 rounded transition">
                    Finalizar Compra
                </button>
            </div>
        </aside>

        <!-- Products Section -->
        <section id="productos" class="mt-12">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold section-title inline-block">TODOS LOS PRODUCTOS</h2>
                <p id="products-count" class="text-gray-500 mt-2"></p>
            </div>

            <div id="product-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <p class="text-gray-500 col-span-full text-center py-10">Cargando productos...</p>
            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer class="bg-primary text-white mt-20 py-10">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="font-bold text-lg mb-4">F√öTBOLSTORE</h3>
                    <p class="text-sm text-gray-300">Tu tienda de confianza para art√≠culos deportivos de calidad.</p>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-4">Contacto</h3>
                    <p class="text-sm text-gray-300">Email: info@futbolstore.com</p>
                    <p class="text-sm text-gray-300">Tel: +1 234 567 890</p>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-4">Horario</h3>
                    <p class="text-sm text-gray-300">Lun - S√°b: 9:30 AM - 6:30 PM</p>
                    <p class="text-sm text-gray-300">Dom: 10:00 AM - 4:00 PM</p>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-sm text-gray-400">
                ¬© 2026 F√∫tbolStore. Todos los derechos reservados.
            </div>
        </div>
    </footer>

    <script>
        // --- CONFIGURACI√ìN DE API LOCAL ---
        const API_URL = 'http://localhost:3000/api';

        // State
        let cart = [];
        let allProducts = [];

        // Fetch Products from Local API
        async function fetchProducts() {
            try {
                console.log('üîç Fetching products from:', `${API_URL}/productos`);
                const response = await fetch(`${API_URL}/productos`);
                console.log('üì° Response status:', response.status, response.ok ? '‚úÖ' : '‚ùå');

                const data = await response.json();
                console.log('üì¶ Data received:', data);
                console.log('üìä Products array:', data.productos);

                const productos = data.productos || [];
                console.log(`‚úÖ ${productos.length} productos encontrados`);

                return productos;
            } catch (error) {
                console.error('‚ùå Error cargando productos:', error);
                return [];
            }
        }

        // Render Functions
        function renderProducts(lista) {
            const grid = document.getElementById('product-grid');
            const countEl = document.getElementById('products-count');

            console.log('üé® Renderizando', lista.length, 'productos');
            countEl.textContent = `${lista.length} productos disponibles`;

            if (!lista || lista.length === 0) {
                grid.innerHTML = '<p class="text-gray-500 col-span-full text-center py-10">No hay productos disponibles</p>';
                return;
            }

            grid.innerHTML = lista.map(p => `
                <div class="product-card bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-xl transition-all duration-300 group cursor-pointer">
                    <div class="relative aspect-square bg-gray-50 overflow-hidden">
                        ${p.imagen_url ? `
                            <img src="${p.imagen_url}" 
                                 class="product-image-main w-full h-full object-cover transition-opacity duration-300" 
                                 alt="${p.nombre}">
                            <img src="${p.imagen_url}" 
                                 class="product-image-hover absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-300" 
                                 alt="${p.nombre}">
                        ` : '<div class="w-full h-full flex items-center justify-center text-6xl">üì¶</div>'}
                    </div>
                    
                    <div class="p-4">
                        <p class="text-xs text-gray-400 mb-1 uppercase tracking-wide">${p.categoria}</p>
                        <h3 class="font-semibold text-sm mb-2 line-clamp-2 group-hover:text-accent transition">${p.nombre}</h3>
                        <p class="text-xs text-gray-500 mb-3 line-clamp-1">${p.codigo}</p>
                        
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-bold text-primary">$${p.precio.toFixed(2)}</span>
                            <button onclick="event.stopPropagation(); addToCart('${p._id}', '${p.nombre.replace(/'/g, "\\'")}', ${p.precio})" 
                                class="bg-primary text-white px-4 py-2 rounded-full text-xs font-medium hover:bg-accent transition">
                                Agregar
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');

            console.log('‚úÖ Productos renderizados en el DOM');
        }

        // Cart Functions
        function addToCart(id, nombre, precio) {
            cart.push({ id, nombre, precio });
            updateCartUI();

            // Show cart sidebar
            document.getElementById('carrito-sidebar').classList.remove('hidden');
            document.getElementById('carrito-overlay').classList.remove('hidden');
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
        }

        function updateCartUI() {
            const container = document.getElementById('cart-items');
            const totalEl = document.getElementById('total-price');
            const countEl = document.getElementById('cart-count');

            countEl.innerText = cart.length;
            countEl.classList.toggle('hidden', cart.length === 0);

            const total = cart.reduce((sum, item) => sum + item.precio, 0);
            totalEl.innerText = total.toFixed(2);

            if (cart.length === 0) {
                container.innerHTML = '<p class="text-sm text-gray-400 italic text-center">Tu carrito est√° vac√≠o</p>';
                return;
            }

            container.innerHTML = cart.map((item, index) => `
                <div class="flex justify-between items-center bg-gray-50 p-3 rounded">
                    <div class="flex-1">
                        <p class="font-medium text-sm">${item.nombre}</p>
                        <p class="text-xs text-gray-500">$${item.precio.toFixed(2)}</p>
                    </div>
                    <button onclick="removeFromCart(${index})" class="text-red-500 hover:text-red-700 font-bold text-xl ml-2">
                        √ó
                    </button>
                </div>
            `).join('');
        }

        function checkout() {
            if (cart.length === 0) return alert("Agrega productos primero");

            const user = JSON.parse(localStorage.getItem('user') || '{}');
            if (!user.email) {
                alert('Debes iniciar sesi√≥n para realizar la compra');
                window.location.href = 'login.html';
                return;
            }

            alert(`Procesando pedido por $${document.getElementById('total-price').innerText}...`);
            cart = [];
            updateCartUI();
            toggleCarrito();
        }

        function toggleCarrito() {
            const sidebar = document.getElementById('carrito-sidebar');
            const overlay = document.getElementById('carrito-overlay');
            sidebar.classList.toggle('hidden');
            overlay.classList.toggle('hidden');
        }

        // Initialize App
        async function initializeApp() {
            console.log('üöÄ Iniciando aplicaci√≥n...');
            console.time('‚è±Ô∏è Tiempo de carga');

            const productos = await fetchProducts();

            console.timeEnd('‚è±Ô∏è Tiempo de carga');
            console.log(`üì¶ ${productos.length} productos cargados`);

            allProducts = productos;
            renderProducts(productos);

            console.log('‚úÖ Aplicaci√≥n inicializada');
        }

        // Auth Functions
        function checkUserSession() {
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            updateAuthUI(user);
        }

        function updateAuthUI(user) {
            const authSection = document.getElementById('auth-section');
            const userSection = document.getElementById('user-section');
            const userNameEl = document.getElementById('user-name');
            const adminLink = document.getElementById('admin-link');

            if (user && user.email) {
                authSection.classList.add('hidden');
                userSection.classList.remove('hidden');
                userNameEl.textContent = user.nombre || user.email.split('@')[0];

                // Show admin panel link if user is admin
                if (user.nivel === 'admin') {
                    adminLink.classList.remove('hidden');
                } else {
                    adminLink.classList.add('hidden');
                }
            } else {
                authSection.classList.remove('hidden');
                userSection.classList.add('hidden');
                adminLink.classList.add('hidden');
            }
        }

        function logout() {
            localStorage.removeItem('user');
            localStorage.removeItem('token');
            window.location.reload();
        }

        // Initialize
        initializeApp();
        checkUserSession();
    </script>
</body>

</html>